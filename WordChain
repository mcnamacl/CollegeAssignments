import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.Scanner;

public class WordChain {

	public static void main(String[] args) {
		boolean finished = false;
		ArrayList<String> words = new ArrayList<String>();
		Scanner input = new Scanner(System.in);
		try {
			BufferedReader bufferedReader = new BufferedReader(new FileReader("wordChecker.txt"));
			words = readDictionary(bufferedReader, words);
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}
		while (!finished) {
			System.out.println(
					"What are the words you would like to input? (separated by commas or an empty list to quit).");
			input = new Scanner(System.in);
			String wordList = input.nextLine();
			if (wordList.length() != 0 && isValid(wordList)) {
				ArrayList<String> wordChain = readWordList(wordList);
				if (isWordChain(wordChain, words)) {
					System.out.println("This is a valid wordchain.");
				} else {
					System.out.println("Uh oh, this is not a valid wordchain.");

				}
			} else if (wordList.length() > 0) {
				System.out.println("Sorry, only letters and commas are valid for this program.");
			} else {
				System.out.println("Goodbye, hope you enjoyed!");
				finished = true;
				input.close();
			}
		}
	}

	public static boolean isValid(String input) {
		return input.matches("[a-z\\s',A-Z]+");
	}

	public static ArrayList<String> readDictionary(BufferedReader bufferedReader, ArrayList<String> words) {
		try {
			String word = bufferedReader.readLine();
			while (word != null) {
				words.add(word);
				word = bufferedReader.readLine();
			}
		} catch (IOException e) {
			e.printStackTrace();
		}
		return words;
	}

	public static ArrayList<String> readWordList(String unsortedWords) {
		String[] sortedWords = unsortedWords.split(", ");
		List<String> sortedList = Arrays.asList(sortedWords);
		ArrayList<String> wordChain = new ArrayList<String>(sortedList);
		return wordChain;
	}

	public static boolean isUniqueList(List<String> wordChain) {
		boolean isUnique = true;
		int indexOfWord = 0;
		int nextWord = 0;
		while (indexOfWord < wordChain.size() && isUnique == true) {
			String wordToCheck = wordChain.get(indexOfWord);
			nextWord = indexOfWord + 1;
			while (nextWord < wordChain.size()) {
				String wordToCheckAgainst = wordChain.get(nextWord);
				if (wordToCheck.equals(wordToCheckAgainst)) {
					isUnique = false;
				}
				nextWord++;
			}
			indexOfWord++;
		}
		return isUnique;
	}

	public static boolean isEnglishWord(ArrayList<String> wordChain, ArrayList<String> words) {
		boolean result = true;
		int indexInDictionary = 0;
		int indexOfWord = 0;
		Collections.sort(wordChain);
		Collections.sort(words);
		while (indexOfWord < wordChain.size()) {
			indexInDictionary = Collections.binarySearch(words, wordChain.get(indexOfWord));
			if (indexInDictionary < 0) {
				result = false;
			}
			indexOfWord++;
		}
		return result;
	}

	public static boolean isDifferentByOne(ArrayList<String> wordChain) {
		boolean isDifferentByOne = true;
		int indexOfWord = 0;
		while (indexOfWord + 1 < wordChain.size() && isDifferentByOne == true) {
			int count = 0;
			int indexOfLetter = 0;
			String wordToCheck = wordChain.get(indexOfWord);
			wordToCheck = wordToCheck.replaceAll("[^a-z\\sA-Z]", "");
			String wordToCheckAgainst = wordChain.get(indexOfWord + 1);
			wordToCheckAgainst = wordToCheckAgainst.replaceAll("[^a-z\\sA-Z]", "");
			if (wordToCheck.length() == wordToCheckAgainst.length()) {
				while (indexOfLetter < wordToCheck.length() && count < 2) {
					char letterToCheck = wordToCheck.charAt(indexOfLetter);
					char letterToCheckAgainst = wordToCheckAgainst.charAt(indexOfLetter);
					if (letterToCheck != letterToCheckAgainst) {
						count++;
					}
					indexOfLetter++;
					if (count > 1) {
						isDifferentByOne = false;
					}
				}
				indexOfWord++;
			} else {
				isDifferentByOne = false;
			}
		}
		return isDifferentByOne;
	}

	public static boolean isWordChain(ArrayList<String> wordChain, ArrayList<String> words) {
		boolean result = false;
		if (wordChain.size() > 1 && isUniqueList(wordChain) && isDifferentByOne(wordChain)
				&& isEnglishWord(wordChain, words)) {
			result = true;
		}
		return result;
	}
}
